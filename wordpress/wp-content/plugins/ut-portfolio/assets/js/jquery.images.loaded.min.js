(function(){function f(){}function h(a,b){for(var e=a.length;e--;)if(a[e].listener===b)return e;return-1}function g(a){return function(){return this[a].apply(this,arguments)}}var d=f.prototype,l=this,c=l.EventEmitter;d.getListeners=function(a){var b=this._getEvents(),e,k;if("object"===typeof a)for(k in e={},b)b.hasOwnProperty(k)&&a.test(k)&&(e[k]=b[k]);else e=b[a]||(b[a]=[]);return e};d.flattenListeners=function(a){var b=[],e;for(e=0;e<a.length;e+=1)b.push(a[e].listener);return b};d.getListenersAsObject= function(a){var b=this.getListeners(a),e;b instanceof Array&&(e={},e[a]=b);return e||b};d.addListener=function(a,b){var e=this.getListenersAsObject(a),k="object"===typeof b,c;for(c in e)e.hasOwnProperty(c)&&-1===h(e[c],b)&&e[c].push(k?b:{listener:b,once:!1});return this};d.on=g("addListener");d.addOnceListener=function(a,b){return this.addListener(a,{listener:b,once:!0})};d.once=g("addOnceListener");d.defineEvent=function(a){this.getListeners(a);return this};d.defineEvents=function(a){for(var b=0;b< a.length;b+=1)this.defineEvent(a[b]);return this};d.removeListener=function(a,b){var e=this.getListenersAsObject(a),c,d;for(d in e)e.hasOwnProperty(d)&&(c=h(e[d],b),-1!==c&&e[d].splice(c,1));return this};d.off=g("removeListener");d.addListeners=function(a,b){return this.manipulateListeners(!1,a,b)};d.removeListeners=function(a,b){return this.manipulateListeners(!0,a,b)};d.manipulateListeners=function(a,b,e){var c,d,f=a?this.removeListener:this.addListener;a=a?this.removeListeners:this.addListeners; if("object"!==typeof b||b instanceof RegExp)for(c=e.length;c--;)f.call(this,b,e[c]);else for(c in b)b.hasOwnProperty(c)&&(d=b[c])&&("function"===typeof d?f.call(this,c,d):a.call(this,c,d));return this};d.removeEvent=function(a){var b=typeof a,e=this._getEvents(),c;if("string"===b)delete e[a];else if("object"===b)for(c in e)e.hasOwnProperty(c)&&a.test(c)&&delete e[c];else delete this._events;return this};d.removeAllListeners=g("removeEvent");d.emitEvent=function(a,b){var c=this.getListenersAsObject(a), d,f,g,h;for(g in c)if(c.hasOwnProperty(g))for(f=c[g].length;f--;)d=c[g][f],!0===d.once&&this.removeListener(a,d.listener),h=d.listener.apply(this,b||[]),h===this._getOnceReturnValue()&&this.removeListener(a,d.listener);return this};d.trigger=g("emitEvent");d.emit=function(a){var b=Array.prototype.slice.call(arguments,1);return this.emitEvent(a,b)};d.setOnceReturnValue=function(a){this._onceReturnValue=a;return this};d._getOnceReturnValue=function(){return this.hasOwnProperty("_onceReturnValue")?this._onceReturnValue: !0};d._getEvents=function(){return this._events||(this._events={})};f.noConflict=function(){l.EventEmitter=c;return f};"function"===typeof define&&define.amd?define("eventEmitter/EventEmitter",[],function(){return f}):"object"===typeof module&&module.exports?module.exports=f:this.EventEmitter=f}).call(this); (function(f){function h(c){var a=f.event;a.target=a.target||a.srcElement||c;return a}var g=document.documentElement,d=function(){};g.addEventListener?d=function(c,a,b){c.addEventListener(a,b,!1)}:g.attachEvent&&(d=function(c,a,b){c[a+b]=b.handleEvent?function(){var a=h(c);b.handleEvent.call(b,a)}:function(){var a=h(c);b.call(c,a)};c.attachEvent("on"+a,c[a+b])});var l=function(){};g.removeEventListener?l=function(c,a,b){c.removeEventListener(a,b,!1)}:g.detachEvent&&(l=function(c,a,b){c.detachEvent("on"+ a,c[a+b]);try{delete c[a+b]}catch(d){c[a+b]=void 0}});g={bind:d,unbind:l};"function"===typeof define&&define.amd?define("eventie/eventie",g):f.eventie=g})(this); (function(f,h){"function"===typeof define&&define.amd?define([f,"eventEmitter/EventEmitter","eventie/eventie"],h):"object"===typeof exports?module.exports=h(f,require("eventEmitter"),require("eventie")):f.imagesLoaded=h(f,f.EventEmitter,f.eventie)})(this,function(f,h,g){function d(a,b){for(var c in b)a[c]=b[c];return a}function l(a){var b=[];if("[object Array]"===p.call(a))b=a;else if("number"===typeof a.length)for(var c=0,d=a.length;c<d;c++)b.push(a[c]);else b.push(a);return b}function c(a,b,f){if(!(this instanceof c))return new c(a,b);"string"===typeof a&&(a=document.querySelectorAll(a));this.elements=l(a);this.options=d({},this.options);"function"===typeof b?f=b:d(this.options,b);if(f)this.on("always",f);this.getImages();e&&(this.jqDeferred=new e.Deferred);var g=this;setTimeout(function(){g.check()})}function a(a){this.img=a}function b(a){this.src=a;m[a]=this}var e=f.jQuery,k=f.console,n="undefined"!==typeof k,p=Object.prototype.toString;c.prototype=new h;c.prototype.options={};c.prototype.getImages=function(){this.images= [];for(var a=0,b=this.elements.length;a<b;a++){var c=this.elements[a];"IMG"===c.nodeName&&this.addImage(c);for(var c=c.querySelectorAll("img"),d=0,e=c.length;d<e;d++)this.addImage(c[d])}};c.prototype.addImage=function(b){b=new a(b);this.images.push(b)};c.prototype.check=function(){function a(e,f){b.options.debug&&n&&k.log("confirm",e,f);b.progress(e);c++;c===d&&b.complete();return!0}var b=this,c=0,d=this.images.length;this.hasAnyBroken=!1;if(d)for(var e=0;e<d;e++){var f=this.images[e];f.on("confirm", a);f.check()}else this.complete()};c.prototype.progress=function(a){this.hasAnyBroken=this.hasAnyBroken||!a.isLoaded;var b=this;setTimeout(function(){b.emit("progress",b,a);b.jqDeferred&&b.jqDeferred.notify&&b.jqDeferred.notify(b,a)})};c.prototype.complete=function(){var a=this.hasAnyBroken?"fail":"done";this.isComplete=!0;var b=this;setTimeout(function(){b.emit(a,b);b.emit("always",b);if(b.jqDeferred)b.jqDeferred[b.hasAnyBroken?"reject":"resolve"](b)})};e&&(e.fn.imagesLoaded=function(b,a){return(new c(this, b,a)).jqDeferred.promise(e(this))});a.prototype=new h;a.prototype.check=function(){var a=m[this.img.src]||new b(this.img.src);if(a.isConfirmed)this.confirm(a.isLoaded,"cached was confirmed");else if(this.img.complete&&void 0!==this.img.naturalWidth)this.confirm(0!==this.img.naturalWidth,"naturalWidth");else{var c=this;a.on("confirm",function(a,b){c.confirm(a.isLoaded,b);return!0});a.check()}};a.prototype.confirm=function(a,b){this.isLoaded=a;this.emit("confirm",this,b)};var m={};b.prototype=new h; b.prototype.check=function(){if(!this.isChecked){var a=new Image;g.bind(a,"load",this);g.bind(a,"error",this);a.src=this.src;this.isChecked=!0}};b.prototype.handleEvent=function(a){var b="on"+a.type;if(this[b])this[b](a)};b.prototype.onload=function(a){this.confirm(!0,"onload");this.unbindProxyEvents(a)};b.prototype.onerror=function(a){this.confirm(!1,"onerror");this.unbindProxyEvents(a)};b.prototype.confirm=function(a,b){this.isConfirmed=!0;this.isLoaded=a;this.emit("confirm",this,b)};b.prototype.unbindProxyEvents= function(a){g.unbind(a.target,"load",this);g.unbind(a.target,"error",this)};return c});