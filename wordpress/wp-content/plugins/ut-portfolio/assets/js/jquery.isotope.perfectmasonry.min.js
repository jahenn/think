(function(l,t){var m=null,n=null,r=!0;l.extend(l.Isotope.prototype,{_perfectMasonryReset:function(){var b="horizontal"!=this.options.perfectMasonry.layout,c=1==this.options.perfectMasonry.liquid;r&&(r=!1,m=l(this.element.context),n=m.parent(),this.options.perfectMasonry.minCols=this.options.perfectMasonry.minCols||1,this.options.perfectMasonry.minRows=this.options.perfectMasonry.minRows||1,this.options.perfectMasonry.maxCols=this.options.perfectMasonry.maxCols||9999,this.options.perfectMasonry.maxRows= this.options.perfectMasonry.maxRows||9999);c&&l._data(window,"events").smartresize&&(l(window).off("smartresize.isotope"),l(window).on("resize.isotope.perfectmasonry",function(){m.hasClass("isotope")&&m.isotope("reLayout")}));var a=this.perfectMasonry={};this._getSegments();this._getSegments(!0);this._perfectMasonryGetSegments();if(c){var c=n.width(),g=n.height();this.options.perfectMasonry.columnWidth=this.options.perfectMasonry.columnWidth||a.columnWidth;this.options.perfectMasonry.rowHeight=this.options.perfectMasonry.rowHeight|| a.rowHeight;a.cols=this.options.perfectMasonry.cols||Math.floor(c/this.options.perfectMasonry.columnWidth);a.rows=this.options.perfectMasonry.rows||Math.floor(g/this.options.perfectMasonry.rowHeight);a.cols=Math.min(Math.max(a.cols,this.options.perfectMasonry.minCols),this.options.perfectMasonry.maxCols);a.rows=Math.min(Math.max(a.rows,this.options.perfectMasonry.minRows),this.options.perfectMasonry.maxRows);b=b?a.columnWidth/(c/a.cols):a.rowHeight/(g/a.rows);a.columnWidth=Math.floor(a.columnWidth/ b);a.rowHeight=Math.floor(a.rowHeight/b)}a.grid=Array(this.perfectMasonry.cols);a.containerHeight=0;a.containerWidth=0},_perfectMasonryLayout:function(b){var c=this,a=this.perfectMasonry,g="horizontal"!=c.options.perfectMasonry.layout,m=1==c.options.perfectMasonry.liquid;a.grid=Array(a[g?"cols":"rows"]);b.each(function(){var b=l(this),h=m?b.data("colSpan"):Math.ceil(b.outerWidth()/(a.columnWidth+1)),p=m?b.data("rowSpan"):Math.ceil(b.outerHeight()/(a.rowHeight+1));h||(h=Math.ceil(b.outerWidth(!0)/ (a.columnWidth+1)),p=Math.ceil(b.outerHeight(!0)/(a.rowHeight+1)),b.data("colSpan",h),b.data("rowSpan",p));for(var n=g?h:p,s=g?p:h,r=Math.max((g?a.cols-h:a.rows-p)+1,1),e=-1,k=0,d=0;1E4>++e;){a.grid[e]=a.grid[e]||[];for(var q=0;q<r;q++)if(!a.grid[e][q]){k=!0;if(1<h||1<p)for(d=0;d<n;d++){for(var f=0;f<s;f++)if(a.grid[e+f]=a.grid[e+f]||[],a.grid[e+f][q+d]){k=!1;break}if(!k)break}if(k){for(d=0;d<n;d++)for(f=0;f<s;f++)a.grid[e+f][q+d]=!0;k=e;d=q;g&&(k=q,d=e);a.containerWidth=Math.max(a.containerWidth, (k+n)*a.columnWidth);a.containerHeight=Math.max(a.containerHeight,(d+s)*a.rowHeight);1==c.options.perfectMasonry.liquid&&b.css({width:a.columnWidth*h,height:a.rowHeight*p});c._pushPosition(b,k*a.columnWidth,d*a.rowHeight);return}}}c._pushPosition(b,-9999,-9999)})},_perfectMasonryGetContainerSize:function(){return{width:this.perfectMasonry.containerWidth,height:this.perfectMasonry.containerHeight}},_perfectMasonryResizeChanged:function(){var b=this.perfectMasonry,c=b.cols,a=b.rows;this._perfectMasonryGetSegments(); return"horizontal"==this.options.perfectMasonry.layout&&a!==b.rows||c!==b.cols?!0:!1},_perfectMasonryGetSegments:function(){var b=this.perfectMasonry,c=this.options.perfectMasonry.parent||this.element.parent(),a=c.width();b.cols=Math.floor(a/b.columnWidth)||1;c=c.height();b.rows=Math.floor(c/b.rowHeight)||1}})})(jQuery);